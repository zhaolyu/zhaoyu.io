---
globs: **/stores/**/*.ts,**/stores/**/*.js
---

# Store Patterns

Svelte stores are used for shared state in SvelteKit applications. Stores are located in `src/lib/stores/`.

## Store Types

- **Writable**: `writable<T>(initial)` - For mutable state
- **Readable**: `readable<T>(initial, start)` - For read-only derived state
- **Derived**: `derived(stores, fn)` - For computed values from other stores

## Creating a Store

Simple store:
```typescript
import { writable } from 'svelte/store';
export const count = writable(0);
```

Store with methods (use `browser` from `$app/environment` for client-side code):
```typescript
import { writable } from 'svelte/store';
import { browser } from '$app/environment';

function createTheme() {
	const { subscribe, set, update } = writable<'light' | 'dark'>('light');
	return {
		subscribe,
		toggle: () => update((current) => current === 'light' ? 'dark' : 'light')
	};
}
```

## Using Stores

**Auto-subscription (Recommended)**:
```svelte
<script lang="ts">
	import { theme } from '$lib/stores/theme';
	$: isDark = $theme === 'dark';
</script>
```

**Manual subscription**: Use `subscribe()` in `onMount` and unsubscribe in `onDestroy`.

**Updating stores**: Use `store.set(value)` or `store.update(fn)`.

## Best Practices

1. **Type safety**: Always define TypeScript types for store values
2. **Store location**: Keep stores in `src/lib/stores/`
3. **Auto-subscription**: Prefer `$store` syntax
4. **Separation**: Keep store logic separate from component logic
5. **Persistence**: Use `browser` check before accessing localStorage/window

See [.cursor/docs/PATTERNS.md](mdc:.cursor/docs/PATTERNS.md) for complete store patterns and examples.
