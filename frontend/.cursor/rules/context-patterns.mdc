---
globs: **/contexts/**/*.ts,**/contexts/**/*.tsx
---

# Context Provider Patterns

React Context is used for shared state in React components. Contexts are located in `src/contexts/` (if using this pattern).

## Context Structure

Each context typically has:
- Context definition file: `ContextName/index.ts` or `ContextName.ts`
- Provider component: `ContextName/ContextNameProvider.tsx` or `ContextNameProvider.tsx`
- Custom hook: `useContextName` hook

## Creating a Context

```typescript
// contexts/DataContext/index.ts
import { createContext, useContext } from 'react';

interface DataContextType {
  data: any;
  loading: boolean;
}

const DataContext = createContext<DataContextType | undefined>(undefined);

export const useData = () => {
  const context = useContext(DataContext);
  if (!context) {
    throw new Error('useData must be used within DataProvider');
  }
  return context;
};

export default DataContext;
```

## Creating a Provider

```typescript
// contexts/DataContext/DataProvider.tsx
import { useState, useEffect, ReactNode } from 'react';
import DataContext from './index';

interface DataProviderProps {
  children: ReactNode;
}

const DataProvider = ({ children }: DataProviderProps) => {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchData = async () => {
      try {
        const response = await fetch('/api/data');
        const result = await response.json();
        setData(result);
      } catch (error) {
        console.error('Failed to fetch data', error);
      } finally {
        setLoading(false);
      }
    };
    fetchData();
  }, []);

  return (
    <DataContext.Provider value={{ data, loading }}>
      {children}
    </DataContext.Provider>
  );
};

export default DataProvider;
```

## Using Context

```typescript
import { useData } from '../contexts/DataContext';

const Component = () => {
  const { data, loading } = useData();
  if (loading) return <div>Loading...</div>;
  return <div>{data && data.title}</div>;
};
```

## Using Context in Astro

When using React Context with Astro, wrap your React components with the provider:

```astro
---
import DataProvider from '../contexts/DataContext/DataProvider';
import MyComponent from '../components/MyComponent';
---

<DataProvider client:load>
  <MyComponent client:load />
</DataProvider>
```

## Best Practices

1. **Type safety**: Always define TypeScript interfaces for context values
2. **Error handling**: Throw errors when context is used outside provider
3. **Performance**: Consider using `useMemo` for context values to prevent unnecessary re-renders
4. **Separation**: Keep context logic separate from component logic

See [.cursor/docs/PATTERNS.md](mdc:.cursor/docs/PATTERNS.md) for complete context patterns.
