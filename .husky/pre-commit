#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

cd "$(git rev-parse --show-toplevel)/frontend" || exit 1

# Run lint-staged (lint on staged files)
echo "ğŸ” Linting staged files..."
npx lint-staged || exit 1

# Run type check (on all files)
echo "ğŸ” Running type check..."
npm run check || {
  echo "âŒ Type check failed. Please fix type errors before committing."
  exit 1
}

# Run lint (on all files)
echo "ğŸ” Running lint check..."
npm run lint || {
  echo "âŒ Lint failed. Please fix linting errors before committing."
  exit 1
}

# Run tests (all tests to ensure nothing broke)
echo "ğŸ§ª Running tests..."
npm run test || {
  echo "âŒ Tests failed. Please fix failing tests before committing."
  exit 1
}

# Run build (ensure the project builds successfully)
echo "ğŸ—ï¸  Running build..."
npm run build || {
  echo "âŒ Build failed. Please fix build errors before committing."
  exit 1
}

echo "âœ… All checks passed!"
